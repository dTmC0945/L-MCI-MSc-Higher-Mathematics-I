<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Code for Higher Mathematics I First Order ODEs</title>
<meta name="author" content="Daniel McGuiness" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<link rel="stylesheet" href="config/style.css">
<script type="text/javascript"  src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="config/test.js">
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
// @license-end
</script>

<script>
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
org_html_manager.set("TOC_DEPTH", "3");
org_html_manager.set("LINK_HOME", "");
org_html_manager.set("LINK_UP", "index.html");
org_html_manager.set("LOCAL_TOC", "1");
org_html_manager.set("VIEW_BUTTONS", "0");
org_html_manager.set("MOUSE_HINT", "underline");
org_html_manager.set("FIXED_TOC", "0");
org_html_manager.set("TOC", "1");
org_html_manager.set("VIEW", "info");
org_html_manager.setup();  // activate after the parameters are set
// @license-end
</script>
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>

<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="index.html"> UP </a>
 |
 <a accesskey="H" href=""> HOME </a>
</div><div id="content" class="content">
<h1 class="title">Code for Higher Mathematics I First Order ODEs</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orgc53a3fd">Introduction</a></li>
<li><a href="#org4439055">Example: Ötzi the Iceman</a></li>
<li><a href="#orgfa287e7">Exercise: The Mixing Problem</a></li>
<li><a href="#org1434e8b">Exercise 2</a></li>
<li><a href="#orgd37b725">Example: An Exact ODE</a></li>
<li><a href="#org68bf958">Example: Simple Calculus</a></li>
<li><a href="#org383ddf2">Example: Subsonic Flight</a></li>
<li><a href="#org96f0841">Example: First-Order ODE, General Solution, Initial Value Problem</a></li>
<li><a href="#org49170db">Example: Electric Circuit</a></li>
</ul>
</div>
</div>
<p>
These are the code snippets used in <span class="Hlight">First Order ODEs</span>
part of <span class="Hlight">Higher Mathematics I</span>.
</p>

<div id="outline-container-orgc53a3fd" class="outline-2">
<h2 id="orgc53a3fd">Introduction</h2>
<div class="outline-text-2" id="text-orgc53a3fd">
<p>
All code herein are solved using SAGEMath, a python based library
focusing on mathematics.
</p>

<p>
Solve the initial value problem
</p>

<p>
\[\rp{\cos y \sinh x} + 1 \dd\x  sin\dd  \y \
</p>

<div class="org-src-container">
<pre class="src src-sage" id="orgaec1d5e"><span class="org-comment-delimiter"># </span><span class="org-comment">Define variables and functions</span>
<span class="org-variable-name">x</span> <span class="org-operator">=</span> var<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'x'</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">y</span> <span class="org-operator">=</span> function<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'y'</span><span class="org-rainbow-delimiters-depth-1">)(</span>x<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Define function</span>
<span class="org-variable-name">func</span> <span class="org-operator">=</span> diff<span class="org-rainbow-delimiters-depth-1">(</span>y,x<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">-</span> <span class="org-rainbow-delimiters-depth-1">(</span>cos<span class="org-rainbow-delimiters-depth-2">(</span>y<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-operator">*</span>sinh<span class="org-rainbow-delimiters-depth-2">(</span>x<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-operator">+</span> 1<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">/</span> <span class="org-rainbow-delimiters-depth-1">(</span>sin<span class="org-rainbow-delimiters-depth-2">(</span>y<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-operator">*</span> cosh<span class="org-rainbow-delimiters-depth-2">(</span>x<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">==</span> 0

<span class="org-comment-delimiter"># </span><span class="org-comment">Solve Equation</span>
desolve<span class="org-rainbow-delimiters-depth-1">(</span>func, y, ics<span class="org-operator">=</span><span class="org-rainbow-delimiters-depth-2">[</span>1,2<span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<pre class="example" id="org9acecee">
-cos(y(x))*cosh(x) - x == -cos(2)*cosh(1) - 1
</pre>

<div class="org-src-container">
<pre class="src src-sage" id="org6ee171e"><span class="org-variable-name">x</span>, <span class="org-variable-name">y</span> <span class="org-operator">=</span> var<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'x, y'</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-variable-name">func</span> <span class="org-operator">=</span> <span class="org-operator">-</span>cos<span class="org-rainbow-delimiters-depth-1">(</span>y<span class="org-rainbow-delimiters-depth-1">)</span><span class="org-operator">*</span>cosh<span class="org-rainbow-delimiters-depth-1">(</span>x<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">-</span> x <span class="org-operator">==</span> <span class="org-operator">-</span>cos<span class="org-rainbow-delimiters-depth-1">(</span>2<span class="org-rainbow-delimiters-depth-1">)</span><span class="org-operator">*</span>cosh<span class="org-rainbow-delimiters-depth-1">(</span>1<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">-</span> 1

<span class="org-variable-name">plt</span> <span class="org-operator">=</span> implicit_plot<span class="org-rainbow-delimiters-depth-1">(</span>func,<span class="org-rainbow-delimiters-depth-2">(</span>x , 0, 3<span class="org-rainbow-delimiters-depth-2">)</span> ,<span class="org-rainbow-delimiters-depth-2">(</span>y, <span class="org-operator">-</span>1, 3<span class="org-rainbow-delimiters-depth-2">)</span>,linewidth<span class="org-operator">=</span>2, color<span class="org-operator">=</span><span class="org-string">'purple'</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-variable-name">kwargs</span> <span class="org-operator">=</span> <span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-string">'xmin'</span> : <span class="org-operator">-</span>0.5 ,
    <span class="org-string">'xmax'</span> : <span class="org-operator">+</span>3 ,
    <span class="org-string">'ymin'</span> : <span class="org-operator">-</span>0.5 ,
    <span class="org-string">'ymax'</span> : <span class="org-operator">+</span>3 ,
    <span class="org-string">'gridlines'</span> : <span class="org-string">'minor'</span> ,
    <span class="org-string">'frame'</span> : <span class="org-constant">False</span> ,
    <span class="org-string">'axes'</span> : <span class="org-constant">True</span> ,
    <span class="org-string">'fig_tight'</span>: <span class="org-constant">True</span>,
    <span class="org-string">'gridlinesstyle'</span>: <span class="org-builtin">dict</span><span class="org-rainbow-delimiters-depth-2">(</span>color<span class="org-operator">=</span><span class="org-string">"</span><span class="custom"><span class="custom-1">#E5E4E2</span></span><span class="org-string">"</span>, linestyle<span class="org-operator">=</span><span class="org-string">":"</span>, linewidth<span class="org-operator">=</span>0.25<span class="org-rainbow-delimiters-depth-2">)</span>,
    <span class="org-string">'transparent'</span> : <span class="org-constant">True</span>,
    <span class="org-string">'figsize'</span> : 6,
    <span class="org-string">'aspect_ratio'</span> : 7<span class="org-operator">/</span>12,
     <span class="org-rainbow-delimiters-depth-1">}</span>

plt.save<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"images/First-Order-ODEs/ivp-ex-a.pdf"</span>,<span class="org-operator">**</span>kwargs<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org4439055" class="outline-2">
<h2 id="org4439055">Example: Ötzi the Iceman</h2>
<div class="outline-text-2" id="text-org4439055">
<p>
In September 1991 the famous Iceman (Oetzi), a mummy from the Neolithic
period of the Stone Age found in the ice of the Oetztal Alps
(hence the name “Oetzi”) in Southern Tyrolia near the Austrian–Italian
border, caused a scientific sensation.
</p>

<p>
When did Oetzi approximately live and die if the ratio of carbon 164C
to carbon 162C in this mummy is 52.5% of that of a living organism?
Physical Information. In the atmosphere and in living organisms,
the ratio of radioactive carbon 164C (made radioactive by cosmic rays)
to ordinary carbon 162C is constant. When an organism dies, its
absorption of 164C by breathing and eating terminates.
</p>

<p>
Hence one can estimate the age of a fossil by comparing the
radioactive carbon ratio in the fossil with that in the atmosphere.
To do this, one needs to know the half-life of 164C, which is 5715
years (CRC Handbook of Chemistry and Physics, 83rd ed.,
Boca Raton: CRC Press, 2002, page 11–52, line 9).
</p>

<div class="org-src-container">
<pre class="src src-sage" id="org6f6137b"><span class="org-comment-delimiter"># </span><span class="org-comment">Define variables and functions</span>
<span class="org-variable-name">k</span>, <span class="org-variable-name">t</span>, <span class="org-variable-name">_C</span> <span class="org-operator">=</span> var<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'k, t, _C'</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">y</span> <span class="org-operator">=</span> function<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'y'</span><span class="org-rainbow-delimiters-depth-1">)(</span>t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Define function</span>
<span class="org-variable-name">func</span> <span class="org-operator">=</span> diff<span class="org-rainbow-delimiters-depth-1">(</span>y, t<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">-</span> k <span class="org-operator">*</span> y <span class="org-operator">==</span> 0

<span class="org-comment-delimiter"># </span><span class="org-comment">Solve Equation</span>
<span class="org-variable-name">eq</span> <span class="org-operator">=</span> desolve<span class="org-rainbow-delimiters-depth-1">(</span>func, y, ivar <span class="org-operator">=</span> t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Use the half-life value of t = 5715</span>
<span class="org-variable-name">sol</span> <span class="org-operator">=</span> solve<span class="org-rainbow-delimiters-depth-1">(</span>eq <span class="org-operator">==</span> 0.5<span class="org-operator">*</span>_C, k<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-variable-name">_inter</span> <span class="org-operator">=</span> sol<span class="org-rainbow-delimiters-depth-1">[</span>0<span class="org-rainbow-delimiters-depth-1">]</span>.subs<span class="org-rainbow-delimiters-depth-1">(</span>t <span class="org-operator">=</span> 5715<span class="org-rainbow-delimiters-depth-1">)</span>

simplify<span class="org-rainbow-delimiters-depth-1">(</span>solve<span class="org-rainbow-delimiters-depth-2">(</span>e<span class="org-operator">**</span><span class="org-rainbow-delimiters-depth-3">(</span>_inter.rhs<span class="org-rainbow-delimiters-depth-4">()</span><span class="org-operator">*</span>t<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-operator">==</span> 0.525, t<span class="org-rainbow-delimiters-depth-2">)[</span>0<span class="org-rainbow-delimiters-depth-2">]</span>.rhs<span class="org-rainbow-delimiters-depth-2">()</span>.n<span class="org-rainbow-delimiters-depth-2">()</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<pre class="example" id="org5f3f2e6">
5312.72499110066
</pre>

<p>
It seems our iceman was around 5300 years ago.
</p>
</div>
</div>

<div id="outline-container-orgfa287e7" class="outline-2">
<h2 id="orgfa287e7">Exercise: The Mixing Problem</h2>
<div class="outline-text-2" id="text-orgfa287e7">
<p>
Mixing problems occur quite frequently in chemical industry.
We explain here how to solve the basic model involving a single tank.
The tank in Fig. 11 contains 1000 gal of water in which initially
100 lb of salt is dissolved. Brine runs in at a rate of 10 gal&gt;min,
and each gallon contains 5 lb of dissoved salt.
</p>

<p>
The mixture in the tank is kept uniform by stirring. Brine runs
out at 10 gal&gt;min. Find the amount of salt in the tank at any time t.
</p>

<div class="org-src-container">
<pre class="src src-sage" id="org832ea07"><span class="org-comment-delimiter"># </span><span class="org-comment">Define variables and functions</span>
<span class="org-variable-name">A</span>, <span class="org-variable-name">B</span>, <span class="org-variable-name">t</span> <span class="org-operator">=</span> var<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'A, B, t'</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">y</span> <span class="org-operator">=</span> function<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'y'</span><span class="org-rainbow-delimiters-depth-1">)(</span>t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Define function</span>
<span class="org-variable-name">func</span> <span class="org-operator">=</span> diff<span class="org-rainbow-delimiters-depth-1">(</span>y, t<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">-</span> A <span class="org-operator">+</span> B <span class="org-operator">*</span> y <span class="org-operator">==</span> 0

<span class="org-comment-delimiter"># </span><span class="org-comment">Solve Equation</span>
<span class="org-variable-name">eq</span> <span class="org-operator">=</span> desolve<span class="org-rainbow-delimiters-depth-1">(</span>func, y, ics <span class="org-operator">=</span> <span class="org-rainbow-delimiters-depth-2">[</span>0, 100<span class="org-rainbow-delimiters-depth-2">]</span>, ivar <span class="org-operator">=</span> t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-variable-name">_inter</span> <span class="org-operator">=</span> eq.subs<span class="org-rainbow-delimiters-depth-1">(</span>A <span class="org-operator">=</span> 50, B <span class="org-operator">=</span> 0.01<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-variable-name">res</span> <span class="org-operator">=</span> _inter.plot<span class="org-rainbow-delimiters-depth-1">(</span>t, 0, 500<span class="org-rainbow-delimiters-depth-1">)</span>

res.save<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"mixing_problem.pdf"</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org1434e8b" class="outline-2">
<h2 id="org1434e8b">Exercise 2</h2>
<div class="outline-text-2" id="text-org1434e8b">
<p>
Using Theorem 1 or 2, find an integrating factor and solve the
initial value problem.
</p>

<div class="org-src-container">
<pre class="src src-sage" id="orgec6bc41"><span class="org-variable-name">x</span> <span class="org-operator">=</span> var<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'x'</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">y</span> <span class="org-operator">=</span> function<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'y'</span><span class="org-rainbow-delimiters-depth-1">)(</span>x<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">func</span> <span class="org-operator">=</span> <span class="org-rainbow-delimiters-depth-1">(</span>diff<span class="org-rainbow-delimiters-depth-2">(</span>y,x<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-operator">-</span> exp<span class="org-rainbow-delimiters-depth-2">(</span>x <span class="org-operator">+</span> y<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-operator">+</span> y <span class="org-operator">*</span> exp<span class="org-rainbow-delimiters-depth-2">(</span>y<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">/</span> <span class="org-rainbow-delimiters-depth-1">(</span>1 <span class="org-operator">-</span> x <span class="org-operator">*</span> exp<span class="org-rainbow-delimiters-depth-2">(</span>y<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">==</span> 0
desolve<span class="org-rainbow-delimiters-depth-1">(</span>func, y, ics<span class="org-operator">=</span><span class="org-rainbow-delimiters-depth-2">[</span>0,<span class="org-operator">-</span>1<span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sage" id="orga4333e4"><span class="org-comment-delimiter"># </span><span class="org-comment">Define the variables</span>
<span class="org-variable-name">A</span>, <span class="org-variable-name">B</span>, <span class="org-variable-name">K</span>, <span class="org-variable-name">w</span>, <span class="org-variable-name">t</span> <span class="org-operator">=</span> var<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'A, B, K, w, t'</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">y</span> <span class="org-operator">=</span> function<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'y'</span><span class="org-rainbow-delimiters-depth-1">)(</span>t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Define the function</span>
<span class="org-variable-name">func</span> <span class="org-operator">=</span> diff<span class="org-rainbow-delimiters-depth-1">(</span>y, t<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">+</span> K <span class="org-operator">*</span> y <span class="org-operator">-</span> A <span class="org-operator">+</span> B <span class="org-operator">*</span> cos <span class="org-rainbow-delimiters-depth-1">(</span>w <span class="org-operator">*</span> t<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">==</span> 0

<span class="org-comment-delimiter"># </span><span class="org-comment">Solve the linear equation</span>
<span class="org-variable-name">hormone</span> <span class="org-operator">=</span> desolve<span class="org-rainbow-delimiters-depth-1">(</span>func, y, ivar <span class="org-operator">=</span> t,  ics<span class="org-operator">=</span><span class="org-rainbow-delimiters-depth-2">[</span>0,0<span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sage" id="org9b9fdd6"><span class="org-comment-delimiter"># </span><span class="org-comment">Enter the substitution variables</span>
<span class="org-variable-name">ploet</span> <span class="org-operator">=</span> test.subs<span class="org-rainbow-delimiters-depth-1">(</span>A<span class="org-operator">=</span>1, B<span class="org-operator">=</span>1, K<span class="org-operator">=</span>0.05, w <span class="org-operator">=</span> pi<span class="org-operator">/</span>12<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-variable-name">plt</span> <span class="org-operator">=</span> ploet.plot<span class="org-rainbow-delimiters-depth-1">(</span>t,0,200<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-variable-name">kwargs</span> <span class="org-operator">=</span> <span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-string">'xmin'</span> : 0 ,
    <span class="org-string">'xmax'</span> : <span class="org-operator">+</span>200 ,
    <span class="org-string">'ymin'</span> : 0 ,
    <span class="org-string">'ymax'</span> : <span class="org-operator">+</span>25 ,
    <span class="org-string">'gridlines'</span> : <span class="org-string">'minor'</span> ,
    <span class="org-string">'frame'</span> : <span class="org-constant">False</span> ,
    <span class="org-string">'axes'</span> : <span class="org-constant">True</span> ,
    <span class="org-string">'fig_tight'</span>: <span class="org-constant">True</span>,
    <span class="org-string">'gridlinesstyle'</span>: <span class="org-builtin">dict</span><span class="org-rainbow-delimiters-depth-2">(</span>color<span class="org-operator">=</span><span class="org-string">"</span><span class="custom"><span class="custom-1">#E5E4E2</span></span><span class="org-string">"</span>, linestyle<span class="org-operator">=</span><span class="org-string">":"</span>, linewidth<span class="org-operator">=</span>0.25<span class="org-rainbow-delimiters-depth-2">)</span>,
    <span class="org-string">'transparent'</span> : <span class="org-constant">True</span>,
    <span class="org-string">'figsize'</span> : 6,
    <span class="org-string">'aspect_ratio'</span> : 10<span class="org-operator">/</span>3,
     <span class="org-rainbow-delimiters-depth-1">}</span>

plt.save<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"images/First-Order-ODEs/hormone-levels.pdf"</span>,<span class="org-operator">**</span>kwargs<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<pre class="example" id="orge62a405">
57/10*e^(3*x)
</pre>

<div class="org-src-container">
<pre class="src src-sage" id="orga9efc0c"><span class="org-variable-name">A</span><span class="org-operator">=</span> var<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'A'</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">B</span><span class="org-operator">=</span> var<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'B'</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">t</span><span class="org-operator">=</span> var<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'t'</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-variable-name">y</span> <span class="org-operator">=</span> function<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'y'</span><span class="org-rainbow-delimiters-depth-1">)(</span>t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-variable-name">func</span> <span class="org-operator">=</span> diff<span class="org-rainbow-delimiters-depth-1">(</span>y, t<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">==</span> A <span class="org-operator">*</span> y <span class="org-operator">-</span> B <span class="org-operator">*</span> y <span class="org-operator">**</span> 2
desolve<span class="org-rainbow-delimiters-depth-1">(</span>func, y, ivar <span class="org-operator">=</span> t<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sage" id="org92fa16c"><span class="org-variable-name">x</span>,<span class="org-variable-name">y</span> <span class="org-operator">=</span> var<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'x, y'</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">y</span> <span class="org-operator">=</span> function<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'y'</span><span class="org-rainbow-delimiters-depth-1">)(</span>x<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-variable-name">func</span> <span class="org-operator">=</span> diff<span class="org-rainbow-delimiters-depth-1">(</span>y, x<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">==</span> <span class="org-rainbow-delimiters-depth-1">(</span>e<span class="org-operator">**</span><span class="org-rainbow-delimiters-depth-2">(</span>x <span class="org-operator">+</span> y<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-operator">+</span> y <span class="org-operator">*</span> e <span class="org-operator">**</span> y<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">/</span> <span class="org-rainbow-delimiters-depth-1">(</span> 1 <span class="org-operator">-</span> x <span class="org-operator">*</span> e<span class="org-operator">**</span> y<span class="org-rainbow-delimiters-depth-1">)</span>

desolve<span class="org-rainbow-delimiters-depth-1">(</span>func, y, ivar <span class="org-operator">=</span> x, ics <span class="org-operator">=</span> <span class="org-rainbow-delimiters-depth-2">[</span>0 , <span class="org-operator">-</span>1<span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<pre class="example" id="orgb00573a">
((x*y(x) + e^x)*e^y(x) + 1)*e^(-y(x)) == e + 1
</pre>


<p>
Time to plot it:
</p>
<div class="org-src-container">
<pre class="src src-sage" id="org254fed0"><span class="org-variable-name">x</span>, <span class="org-variable-name">y</span> <span class="org-operator">=</span> var<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'x, y'</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-variable-name">func</span> <span class="org-operator">=</span> <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-rainbow-delimiters-depth-2">(</span>x<span class="org-operator">*</span>y <span class="org-operator">+</span> e<span class="org-operator">^</span>x<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-operator">*</span>e<span class="org-operator">^</span>y <span class="org-operator">+</span> 1<span class="org-rainbow-delimiters-depth-1">)</span><span class="org-operator">*</span>e<span class="org-operator">^</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-operator">-</span>y<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">==</span> e <span class="org-operator">+</span> 1

<span class="org-variable-name">p</span> <span class="org-operator">=</span> implicit_plot<span class="org-rainbow-delimiters-depth-1">(</span>func,<span class="org-rainbow-delimiters-depth-2">(</span>x , <span class="org-operator">-</span>5, 2<span class="org-rainbow-delimiters-depth-2">)</span> ,<span class="org-rainbow-delimiters-depth-2">(</span>y, <span class="org-operator">-</span>3, 3<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

p.save<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"test.pdf"</span>, gridlines<span class="org-operator">=</span><span class="org-constant">True</span><span class="org-rainbow-delimiters-depth-1">)</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-orgd37b725" class="outline-2">
<h2 id="orgd37b725">Example: An Exact ODE</h2>
<div class="outline-text-2" id="text-orgd37b725">
<p>
Solve the following equation
</p>

\begin{equation}
\cos \rp{x + y} \dd x + \rp{3x^2 + 2y + \cos \rp{x + y}} \dd y = 0
\end{equation}

<div class="org-src-container">
<pre class="src src-sage" id="org7d15b9d"><span class="org-variable-name">x</span> <span class="org-operator">=</span> var<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'x'</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">y</span> <span class="org-operator">=</span> function<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'y'</span><span class="org-rainbow-delimiters-depth-1">)(</span>x<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-variable-name">func</span> <span class="org-operator">=</span> cos<span class="org-rainbow-delimiters-depth-1">(</span>x <span class="org-operator">+</span> y<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">+</span> <span class="org-rainbow-delimiters-depth-1">(</span>3<span class="org-operator">*</span>y<span class="org-operator">**</span>2 <span class="org-operator">+</span> 2<span class="org-operator">*</span>y <span class="org-operator">+</span> cos<span class="org-rainbow-delimiters-depth-2">(</span>x <span class="org-operator">+</span> y<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span><span class="org-operator">*</span> diff<span class="org-rainbow-delimiters-depth-1">(</span>y, x<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">==</span> 0

desolve<span class="org-rainbow-delimiters-depth-1">(</span>func, y, ivar <span class="org-operator">=</span> x<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<pre class="example" id="orga4088d0">
y(x)^3 + y(x)^2 + sin(x + y(x)) == _C
</pre>

<p>
where <span class="Code">_C</span> is an arbitrary constant.
</p>
</div>
</div>


<div id="outline-container-org68bf958" class="outline-2">
<h2 id="org68bf958">Example: Simple Calculus</h2>
<div class="outline-text-2" id="text-org68bf958">
<p>
Solve the following ODEs by integration.
</p>

\begin{align*}
y' &= - \sin \pi x, \\
y' &= e ^{-3x}, \\
y' &= x e^{x^2/2}, \\
y' &= \cosh{4x}.
\end{align*}

<div class="org-src-container">
<pre class="src src-sage" id="org9d75322"><span class="org-keyword">from</span> sage.symbolic.integration.integral <span class="org-keyword">import</span> indefinite_integral

<span class="org-variable-name">x</span> <span class="org-operator">=</span> var<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'x'</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">y</span> <span class="org-operator">=</span> function<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'y'</span><span class="org-rainbow-delimiters-depth-1">)(</span>x<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-builtin">print</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"(i)   "</span>, indefinite_integral<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-operator">-</span>sin<span class="org-rainbow-delimiters-depth-3">(</span>pi<span class="org-operator">*</span>x<span class="org-rainbow-delimiters-depth-3">)</span>, x<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-builtin">print</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"(ii)  "</span>, indefinite_integral<span class="org-rainbow-delimiters-depth-2">(</span>e<span class="org-operator">**</span><span class="org-rainbow-delimiters-depth-3">(</span><span class="org-operator">-</span>3<span class="org-operator">*</span>x<span class="org-rainbow-delimiters-depth-3">)</span>, x<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-builtin">print</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"(iii) "</span>, indefinite_integral<span class="org-rainbow-delimiters-depth-2">(</span>x<span class="org-operator">*</span>e<span class="org-operator">**</span><span class="org-rainbow-delimiters-depth-3">(</span>x<span class="org-operator">**</span>2<span class="org-operator">/</span>2<span class="org-rainbow-delimiters-depth-3">)</span>, x<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-builtin">print</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"(iv)  "</span>, indefinite_integral<span class="org-rainbow-delimiters-depth-2">(</span>cosh<span class="org-rainbow-delimiters-depth-3">(</span>4<span class="org-operator">*</span>x<span class="org-rainbow-delimiters-depth-3">)</span>, x<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<pre class="example" id="org398da4b">
(i)    cos(pi*x)/pi
(ii)   -1/3*e^(-3*x)
(iii)  e^(1/2*x^2)
(iv)   1/4*sinh(4*x)
</pre>
</div>
</div>

<div id="outline-container-org383ddf2" class="outline-2">
<h2 id="org383ddf2">Example: Subsonic Flight</h2>
<div class="outline-text-2" id="text-org383ddf2">
<p>
The efficiency of the engines of subsonic airplanes depends on
<span class="Hlight">air pressure</span> and usually is maximum near about 36 000 ft.
</p>

<p>
Find the air pressure \(y(x)\) at this height without calculation.
</p>

<p>
<span class="Note">Note:</span> The rate of change (y'(x)) is proportional to the
pressure, and at 18 000 ft the pressure has decreased to half its
value \(y_0\) at sea level.
</p>

<div class="org-src-container">
<pre class="src src-sage" id="org7a52d79"><span class="org-variable-name">x</span>, <span class="org-variable-name">k</span>, <span class="org-variable-name">_C</span> <span class="org-operator">=</span> var<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'x, k, _C'</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">y</span> <span class="org-operator">=</span> function<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'y'</span><span class="org-rainbow-delimiters-depth-1">)(</span>x<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-variable-name">func</span> <span class="org-operator">=</span> diff<span class="org-rainbow-delimiters-depth-1">(</span>y, x<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">-</span> k <span class="org-operator">*</span> y <span class="org-operator">==</span> 0

<span class="org-variable-name">_inter</span> <span class="org-operator">=</span> desolve<span class="org-rainbow-delimiters-depth-1">(</span>func, y, ivar <span class="org-operator">=</span> x<span class="org-rainbow-delimiters-depth-1">)</span>

solve<span class="org-rainbow-delimiters-depth-1">(</span>_inter.subs<span class="org-rainbow-delimiters-depth-2">(</span>x <span class="org-operator">=</span> 18000<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-operator">-</span> _C <span class="org-operator">*</span> 1<span class="org-operator">/</span>2 <span class="org-operator">==</span> 0, k<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<pre class="example" id="org8854444">
_C*e^(18000*k)
</pre>
</div>
</div>

<div id="outline-container-org96f0841" class="outline-2">
<h2 id="org96f0841">Example: First-Order ODE, General Solution, Initial Value Problem</h2>
<div class="outline-text-2" id="text-org96f0841">
<p>
Solve the initial problem
</p>

<p>
\[y' + y \tan x = \sin 2x, \qquad y(0) = 1 \]
</p>

<div class="org-src-container">
<pre class="src src-sage" id="org948d4f7"><span class="org-comment-delimiter"># </span><span class="org-comment">Define variables and functions</span>
<span class="org-variable-name">x</span> <span class="org-operator">=</span> var<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'x'</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">y</span> <span class="org-operator">=</span> function<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'y'</span><span class="org-rainbow-delimiters-depth-1">)(</span>x<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-variable-name">func</span> <span class="org-operator">=</span> diff<span class="org-rainbow-delimiters-depth-1">(</span>y, x<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">+</span> y <span class="org-operator">*</span> tan<span class="org-rainbow-delimiters-depth-1">(</span>x<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">==</span> sin<span class="org-rainbow-delimiters-depth-1">(</span>2<span class="org-operator">*</span>x<span class="org-rainbow-delimiters-depth-1">)</span>

desolve<span class="org-rainbow-delimiters-depth-1">(</span>func, y, ivar<span class="org-operator">=</span> x, ics <span class="org-operator">=</span> <span class="org-rainbow-delimiters-depth-2">[</span>0 , 1<span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<pre class="example" id="org35cf3d0">
-(2*cos(x) - 3)/sec(x)
</pre>
</div>
</div>

<div id="outline-container-org49170db" class="outline-2">
<h2 id="org49170db">Example: Electric Circuit</h2>
<div class="outline-text-2" id="text-org49170db">
<div class="org-src-container">
<pre class="src src-sage" id="org871d21e"><span class="org-variable-name">R</span>, <span class="org-variable-name">L</span>, <span class="org-variable-name">E</span>, <span class="org-variable-name">t</span> <span class="org-operator">=</span> var<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'R, L, E, t'</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">I</span> <span class="org-operator">=</span> function<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'I'</span><span class="org-rainbow-delimiters-depth-1">)(</span>t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-variable-name">func</span> <span class="org-operator">=</span> diff<span class="org-rainbow-delimiters-depth-1">(</span>I, t<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">+</span> R <span class="org-operator">/</span> L <span class="org-operator">*</span> I <span class="org-operator">==</span> E <span class="org-operator">/</span> L

<span class="org-variable-name">_inter</span> <span class="org-operator">=</span> desolve<span class="org-rainbow-delimiters-depth-1">(</span>func, I, ivar <span class="org-operator">=</span> t, ics <span class="org-operator">=</span> <span class="org-rainbow-delimiters-depth-2">[</span>0, 0<span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-variable-name">eq</span> <span class="org-operator">=</span> simplify<span class="org-rainbow-delimiters-depth-1">(</span>_inter.subs<span class="org-rainbow-delimiters-depth-2">(</span>E<span class="org-operator">=</span>48, R<span class="org-operator">=</span>11, L<span class="org-operator">=</span>0.1<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-builtin">print</span><span class="org-rainbow-delimiters-depth-1">(</span>eq<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<pre class="example" id="org89ba812">
48/11*(e^(110.0*t) - 1)*e^(-110.0*t)
</pre>

<div class="org-src-container">
<pre class="src src-sage" id="org1813102"><span class="org-variable-name">plt</span> <span class="org-operator">=</span> _inter.subs<span class="org-rainbow-delimiters-depth-1">(</span>E<span class="org-operator">=</span>48, R<span class="org-operator">=</span>11, L<span class="org-operator">=</span>0.1<span class="org-rainbow-delimiters-depth-1">)</span>.plot<span class="org-rainbow-delimiters-depth-1">(</span>t,0,0.05<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-variable-name">kwargs</span> <span class="org-operator">=</span> <span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-string">'xmin'</span> : 0 ,
    <span class="org-string">'xmax'</span> : <span class="org-operator">+</span>0.05 ,
    <span class="org-string">'ymin'</span> : 0 ,
    <span class="org-string">'ymax'</span> : <span class="org-operator">+</span>8 ,
    <span class="org-string">'gridlines'</span> : <span class="org-string">'minor'</span> ,
    <span class="org-string">'frame'</span> : <span class="org-constant">False</span> ,
    <span class="org-string">'axes'</span> : <span class="org-constant">True</span> ,
    <span class="org-string">'fig_tight'</span>: <span class="org-constant">True</span>,
    <span class="org-string">'gridlinesstyle'</span>: <span class="org-builtin">dict</span><span class="org-rainbow-delimiters-depth-2">(</span>color<span class="org-operator">=</span><span class="org-string">"</span><span class="custom"><span class="custom-1">#E5E4E2</span></span><span class="org-string">"</span>, linestyle<span class="org-operator">=</span><span class="org-string">":"</span>, linewidth<span class="org-operator">=</span>0.25<span class="org-rainbow-delimiters-depth-2">)</span>,
    <span class="org-string">'transparent'</span> : <span class="org-constant">True</span>,
     <span class="org-rainbow-delimiters-depth-1">}</span>

plt.save<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"images/First-Order-ODEs/electrical-circuit.pdf"</span>,<span class="org-operator">**</span>kwargs<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sage" id="org876ace4"><span class="org-variable-name">x</span> <span class="org-operator">=</span> var<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'x'</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">y</span> <span class="org-operator">=</span> function<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'y'</span><span class="org-rainbow-delimiters-depth-1">)(</span>x<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Define function</span>
<span class="org-variable-name">func</span> <span class="org-operator">=</span> diff<span class="org-rainbow-delimiters-depth-1">(</span>y, x<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">-</span> 3 <span class="org-operator">*</span> y <span class="org-operator">==</span> 0

<span class="org-comment-delimiter"># </span><span class="org-comment">Solve Equation</span>
desolve<span class="org-rainbow-delimiters-depth-1">(</span>func, y, ivar <span class="org-operator">=</span> x, ics<span class="org-operator">=</span><span class="org-rainbow-delimiters-depth-2">[</span>0, 5.7<span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<pre class="example" id="org3c7ab03">
57/10*e^(3*x)
</pre>

<div class="org-src-container">
<pre class="src src-sage" id="org035b4cb"><span class="org-variable-name">x</span> <span class="org-operator">=</span> var<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'x'</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">y</span> <span class="org-operator">=</span> function<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'y'</span><span class="org-rainbow-delimiters-depth-1">)(</span>x<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Define function</span>
<span class="org-variable-name">func</span> <span class="org-operator">=</span> diff<span class="org-rainbow-delimiters-depth-1">(</span>y,x<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">+</span> y <span class="org-operator">*</span> tan<span class="org-rainbow-delimiters-depth-1">(</span>x<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">==</span> sin<span class="org-rainbow-delimiters-depth-1">(</span>x<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Solve Equation</span>
desolve<span class="org-rainbow-delimiters-depth-1">(</span>func, y, ivar <span class="org-operator">=</span> x<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<pre class="example" id="org410bb01">
1/2*(2*_C - log(-sin(x)^2 + 1))/sec(x)
</pre>
<div class="org-src-container">
<pre class="src src-sage" id="orgc4d36fc"><span class="org-variable-name">x</span> <span class="org-operator">=</span> var<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'x'</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">y</span> <span class="org-operator">=</span> function<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'y'</span><span class="org-rainbow-delimiters-depth-1">)(</span>x<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Define function</span>
<span class="org-variable-name">func</span> <span class="org-operator">=</span> diff<span class="org-rainbow-delimiters-depth-1">(</span>y, x<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">-</span> cos<span class="org-rainbow-delimiters-depth-1">(</span>x<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">==</span> 0

<span class="org-comment-delimiter"># </span><span class="org-comment">Solve Equation</span>
desolve<span class="org-rainbow-delimiters-depth-1">(</span>func, y, ivar <span class="org-operator">=</span> x<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<pre class="example" id="org5fd18b4">
_C + sin(x)
</pre>

<div class="org-src-container">
<pre class="src src-sage" id="org676497e"><span class="org-variable-name">x</span> <span class="org-operator">=</span> var<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'x'</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">y</span> <span class="org-operator">=</span> function<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'y'</span><span class="org-rainbow-delimiters-depth-1">)(</span>x<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Define function</span>
<span class="org-variable-name">func</span> <span class="org-operator">=</span> diff<span class="org-rainbow-delimiters-depth-1">(</span>y, x<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">-</span> 3 <span class="org-operator">*</span> y <span class="org-operator">==</span> 0

<span class="org-comment-delimiter"># </span><span class="org-comment">Solve Equation</span>
desolve<span class="org-rainbow-delimiters-depth-1">(</span>func, y, ivar <span class="org-operator">=</span> x, ics<span class="org-operator">=</span><span class="org-rainbow-delimiters-depth-2">[</span>0, 5.7<span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<pre class="example" id="org7249599">
57/10*e^(3*x)
</pre>

<div class="org-src-container">
<pre class="src src-sage" id="orge1149b9"><span class="org-variable-name">x</span> <span class="org-operator">=</span> var<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'x'</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">y</span> <span class="org-operator">=</span> function<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'y'</span><span class="org-rainbow-delimiters-depth-1">)(</span>x<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Define function</span>
<span class="org-variable-name">func</span> <span class="org-operator">=</span> 2<span class="org-operator">*</span>x<span class="org-operator">*</span>y<span class="org-operator">*</span>diff<span class="org-rainbow-delimiters-depth-1">(</span>y, x<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">==</span> y<span class="org-operator">**</span>2 <span class="org-operator">-</span> x<span class="org-operator">**</span>2

<span class="org-comment-delimiter"># </span><span class="org-comment">Solve Equation</span>
<span class="org-variable-name">eq</span> <span class="org-operator">=</span> solve<span class="org-rainbow-delimiters-depth-1">(</span>desolve<span class="org-rainbow-delimiters-depth-2">(</span>func, y, ivar <span class="org-operator">=</span> x<span class="org-rainbow-delimiters-depth-2">)</span>,y<span class="org-rainbow-delimiters-depth-1">)[</span>0<span class="org-rainbow-delimiters-depth-1">]</span>

<span class="org-builtin">print</span><span class="org-rainbow-delimiters-depth-1">(</span>eq<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<pre class="example" id="org7cb03ea">
y(x) == -sqrt(-x^2 - x/_C)
</pre>

<div class="org-src-container">
<pre class="src src-sage" id="org1c974ab"><span class="org-variable-name">x</span> <span class="org-operator">=</span> var<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'x'</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">y</span> <span class="org-operator">=</span> function<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'y'</span><span class="org-rainbow-delimiters-depth-1">)(</span>x<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Define function</span>
<span class="org-variable-name">func</span> <span class="org-operator">=</span> diff<span class="org-rainbow-delimiters-depth-1">(</span>y, x<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">==</span> <span class="org-operator">-</span> cos<span class="org-rainbow-delimiters-depth-1">(</span>x <span class="org-operator">+</span> y<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">/</span> <span class="org-rainbow-delimiters-depth-1">(</span>3<span class="org-operator">*</span>y<span class="org-operator">**</span>2 <span class="org-operator">+</span> 2<span class="org-operator">*</span>y <span class="org-operator">+</span> cos<span class="org-rainbow-delimiters-depth-2">(</span>x <span class="org-operator">+</span> y<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Solve Equation</span>
<span class="org-variable-name">eq</span> <span class="org-operator">=</span> desolve<span class="org-rainbow-delimiters-depth-1">(</span>func, y, ivar <span class="org-operator">=</span> x<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-builtin">print</span><span class="org-rainbow-delimiters-depth-1">(</span>eq<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<pre class="example" id="orgd4d3709">
y(x)^3 + y(x)^2 + sin(x + y(x)) == _C
</pre>

<div class="org-src-container">
<pre class="src src-sage" id="orge893541"><span class="org-variable-name">A</span>, <span class="org-variable-name">B</span>, <span class="org-variable-name">t</span><span class="org-operator">=</span> var<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'A, B, t'</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-variable-name">y</span> <span class="org-operator">=</span> function<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'y'</span><span class="org-rainbow-delimiters-depth-1">)(</span>t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-variable-name">func</span> <span class="org-operator">=</span> diff<span class="org-rainbow-delimiters-depth-1">(</span>y, t<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">==</span> A <span class="org-operator">*</span> y <span class="org-operator">-</span> B <span class="org-operator">*</span> y <span class="org-operator">**</span> 2

desolve<span class="org-rainbow-delimiters-depth-1">(</span>func, y, ivar <span class="org-operator">=</span> <span class="org-rainbow-delimiters-depth-1">)</span>

</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Daniel McGuiness</p>
</div>
</body>
</html>
